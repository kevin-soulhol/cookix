{
  "version": 3,
  "sources": ["../../../app/routes/invitation.$token.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/invitation.$token.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/invitation.$token.tsx\");\n  import.meta.hot.lastModified = \"1742653529970.773\";\n}\n// REMIX HMR END\n\nimport { json, redirect } from \"@remix-run/node\";\nimport { Form, useLoaderData } from \"@remix-run/react\";\nimport { useState } from \"react\";\nimport { getUserId } from \"./api.user\";\nimport { prisma } from \"~/utils/db.server\";\nexport async function loader({\n  params,\n  request\n}) {\n  const {\n    token\n  } = params;\n  const userId = await getUserId(request);\n  if (!token) {\n    return redirect(\"/\");\n  }\n  try {\n    // V\u00E9rifier si le jeton existe\n    const invitation = await prisma.menuShare.findFirst({\n      where: {\n        token\n      },\n      include: {\n        menu: true,\n        sharedByUser: {\n          select: {\n            email: true\n          }\n        }\n      }\n    });\n    if (!invitation) {\n      return json({\n        success: false,\n        message: \"Cette invitation n'existe pas ou a expir\u00E9\"\n      });\n    }\n    if (invitation.isAccepted) {\n      return json({\n        success: false,\n        message: \"Cette invitation a d\u00E9j\u00E0 \u00E9t\u00E9 accept\u00E9e\"\n      });\n    }\n    return json({\n      success: true,\n      invitation,\n      isLoggedIn: !!userId\n    });\n  } catch (error) {\n    console.error(\"Erreur lors de la v\u00E9rification de l'invitation:\", error);\n    return json({\n      success: false,\n      message: \"Une erreur est survenue lors de la v\u00E9rification de l'invitation\"\n    });\n  }\n}\nexport default function InvitationPage() {\n  _s();\n  const {\n    success,\n    invitation,\n    message,\n    isLoggedIn\n  } = useLoaderData();\n  const [acceptingInvitation, setAcceptingInvitation] = useState(false);\n  if (!success) {\n    return <div className=\"min-h-screen bg-gray-100 flex flex-col justify-center items-center p-6\">\n                <div className=\"bg-white p-8 rounded-lg shadow-md max-w-md w-full\">\n                    <div className=\"text-center\">\n                        <svg className=\"mx-auto h-12 w-12 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                        </svg>\n                        <h2 className=\"mt-3 text-lg font-medium text-gray-900\">Erreur</h2>\n                        <p className=\"mt-2 text-gray-600\">{message}</p>\n                        <div className=\"mt-5\">\n\n                            <a href=\"/\" className=\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500\">\n                                Retour \u00E0 l'accueil\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            </div>;\n  }\n  return <div className=\"min-h-screen bg-gray-100 flex flex-col justify-center items-center p-6\">\n            <div className=\"bg-white p-8 rounded-lg shadow-md max-w-md w-full\">\n                <div className=\"text-center\">\n                    <svg className=\"mx-auto h-12 w-12 text-rose-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n                    </svg>\n                    <h2 className=\"mt-3 text-xl font-bold text-gray-900\">Invitation Cookix</h2>\n\n                    <p className=\"mt-2 text-gray-600\">\n                        {invitation.sharedByUser.email} a partag\u00E9 {invitation.includeShoppingList ? 'un menu et une liste de courses' : 'un menu'} avec vous.\n                    </p>\n\n                    <div className=\"mt-5 text-left\">\n                        <h3 className=\"font-medium text-gray-700\">D\u00E9tails du menu:</h3>\n                        <p className=\"mt-1 text-gray-600\">\n                            <span className=\"font-medium\">Nom:</span> {invitation.menu.name}\n                        </p>\n                        <p className=\"text-gray-600\">\n                            <span className=\"font-medium\">P\u00E9riode:</span> {new Date(invitation.menu.startDate).toLocaleDateString()} - {new Date(invitation.menu.endDate).toLocaleDateString()}\n                        </p>\n\n                        {invitation.includeShoppingList && <div className=\"mt-3 p-2 bg-teal-50 border border-teal-200 rounded-md\">\n                                <p className=\"text-teal-700 text-sm\">\n                                    <svg className=\"inline-block w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z\" />\n                                    </svg>\n                                    La liste de courses associ\u00E9e sera \u00E9galement partag\u00E9e avec vous.\n                                </p>\n                            </div>}\n                    </div>\n\n                    <div className=\"mt-6\">\n                        {isLoggedIn ? <Form method=\"post\" action=\"/api/share\">\n                                <input type=\"hidden\" name=\"_action\" value=\"acceptShare\" />\n                                <input type=\"hidden\" name=\"token\" value={invitation.token} />\n\n                                <button type=\"submit\" className=\"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500\" onClick={() => setAcceptingInvitation(true)} disabled={acceptingInvitation}>\n                                    {acceptingInvitation ? 'Acceptation en cours...' : 'Accepter l\\'invitation'}\n                                </button>\n                            </Form> : <div>\n                                <p className=\"mb-3 text-sm text-gray-600\">Vous devez vous connecter pour accepter cette invitation.</p>\n                                <a href={`/login?redirectTo=/invitation/${invitation.token}`} className=\"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500\">\n                                    Se connecter\n                                </a>\n                            </div>}\n\n\n                        <a href=\"/\" className=\"mt-3 w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500\">\n                            Retour \u00E0 l'accueil\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>;\n}\n_s(InvitationPage, \"53SEBOxBJCsnZWwtB66KX3aOy7I=\", false, function () {\n  return [useLoaderData];\n});\n_c = InvitationPage;\nvar _c;\n$RefreshReg$(_c, \"InvitationPage\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["import_react"]
}
